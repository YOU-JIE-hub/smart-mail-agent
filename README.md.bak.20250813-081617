# Smart Mail Agent

可離線運行的郵件處理/自動化專案：
- 意圖分類（離線 stub；可切換 Hugging Face / OpenAI）
- 垃圾信/白名單 Orchestrator（規則 + 動作）
- 報價單 PDF（缺字型自動回退 Helvetica）
- CLI：python -m src.run_action_handler
- 離線測試全綠

## 快速開始
```bash
python -m venv .venv
source .venv/bin/activate
python -m pip install -U pip
python -m pip install -r requirements.txt
OFFLINE=1 PYTHONPATH=src pytest -q -k "not online"
```

## 執行 CLI
```bash
PYTHONPATH=src python -m src.run_action_handler --help
```

## 品質檢查
```bash
python -m isort .
python -m black .
python -m flake8
```

<!-- CLI_QUICK_EXAMPLE:START -->
### CLI 快速示例（離線）
mkdir -p data/output
# 準備一份分類結果輸入；離線模式不會連外，僅產出可驗收 out.json
cat > data/output/in.json <<'JSON'
{"subject":"please send quote","from":"alice@example.com","body":"need quotation","predicted_label":"send_quote","confidence":0.95,"attachments":[]}
JSON
OFFLINE=1 PYTHONPATH=src python -m src.run_action_handler --input data/output/in.json --output data/output/out.json
cat data/output/out.json
<!-- CLI_QUICK_EXAMPLE:END -->

<!-- E2E_OFFLINE:START -->
### E2E 測試（離線）
# 僅執行不依賴外網的測試與 E2E
OFFLINE=1 PYTHONPATH=src pytest -q -k "not online or e2e"
<!-- E2E_OFFLINE:END -->
